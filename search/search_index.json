{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"AI-BOM: AI Bill of Materials","text":"<p>Discover and inventory all AI/LLM agents, models, and API integrations across your infrastructure.</p> <p>AI-BOM is a security scanner that creates a comprehensive inventory of AI components in your codebase, similar to how an SBOM (Software Bill of Materials) inventories software dependencies.</p>"},{"location":"#what-it-detects","title":"What It Detects","text":"<ul> <li>AI SDK imports \u2014 OpenAI, Anthropic, LangChain, HuggingFace, and 50+ more</li> <li>Model references \u2014 GPT-4, Claude, Gemini, Llama, and version pinning issues</li> <li>API keys \u2014 Hardcoded credentials for AI services</li> <li>Docker/K8s AI services \u2014 Ollama, vLLM, vector databases</li> <li>Cloud AI services \u2014 AWS Bedrock, GCP Vertex AI, Azure OpenAI (via Terraform/CloudFormation)</li> <li>n8n AI workflows \u2014 LangChain agents, LLM nodes, MCP tools</li> <li>Jupyter notebooks \u2014 AI imports and model loading in notebooks</li> <li>GitHub Actions \u2014 AI-powered actions and API key env vars</li> <li>MCP servers \u2014 Model Context Protocol server configurations</li> <li>Binary model files \u2014 .onnx, .pt, .safetensors, .gguf, and more</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>pip install ai-bom\nai-bom scan .\n</code></pre>"},{"location":"#output-formats","title":"Output Formats","text":"<p>AI-BOM supports 9 output formats:</p> Format Flag Use Case Table <code>--format table</code> Terminal display (default) CycloneDX <code>--format cyclonedx</code> SBOM standard SARIF <code>--format sarif</code> GitHub Code Scanning SPDX 3.0 <code>--format spdx3</code> SBOM standard HTML <code>--format html</code> Shareable reports CSV <code>--format csv</code> Spreadsheet import JUnit <code>--format junit</code> CI/CD integration Markdown <code>--format markdown</code> Documentation JSON <code>--format json</code> API integration"},{"location":"api/","title":"REST API","text":"<p>Start the API server:</p> <pre><code>ai-bom serve --port 8080\n</code></pre>"},{"location":"api/#endpoints","title":"Endpoints","text":""},{"location":"api/#get-health","title":"<code>GET /health</code>","text":"<p>Health check.</p> <p>Response: <code>{\"status\": \"ok\", \"version\": \"3.0.0\"}</code></p>"},{"location":"api/#get-version","title":"<code>GET /version</code>","text":"<p>Version info.</p> <p>Response: <code>{\"version\": \"3.0.0\", \"name\": \"ai-bom\"}</code></p>"},{"location":"api/#post-scan","title":"<code>POST /scan</code>","text":"<p>Scan a directory path.</p> <p>Request: <pre><code>{\n  \"path\": \"/path/to/scan\",\n  \"deep\": false,\n  \"severity\": null\n}\n</code></pre></p> <p>Response: Full scan result JSON with components, summary, and risk assessments.</p>"},{"location":"api/#get-scanners","title":"<code>GET /scanners</code>","text":"<p>List available scanners.</p> <p>Response: <pre><code>[\n  {\"name\": \"code\", \"description\": \"...\", \"enabled\": true},\n  ...\n]\n</code></pre></p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#v300-unreleased","title":"v3.0.0 (Unreleased)","text":""},{"location":"changelog/#new-scanners","title":"New Scanners","text":"<ul> <li>GitHub Actions scanner \u2014 detect AI-powered actions and API key env vars</li> <li>Jupyter Notebook scanner \u2014 detect AI imports in .ipynb files</li> <li>Binary Model File scanner \u2014 detect .onnx, .pt, .safetensors, etc.</li> <li>MCP Config scanner \u2014 detect MCP server declarations</li> </ul>"},{"location":"changelog/#new-output-formats","title":"New Output Formats","text":"<ul> <li>CSV reporter for spreadsheet analysis</li> <li>JUnit XML reporter for CI/CD integration</li> </ul>"},{"location":"changelog/#new-features","title":"New Features","text":"<ul> <li><code>--verbose/-v</code> flag for scanner details and timing</li> <li><code>--debug</code> flag for full stack traces</li> <li><code>.ai-bomignore</code> file support (gitignore syntax)</li> <li><code>.ai-bom.yml</code> configuration file support</li> <li><code>ai-bom list-scanners</code> command</li> <li><code>ai-bom diff</code> command to compare two scans</li> <li><code>ai-bom serve</code> REST API server mode</li> <li>OWASP Agentic Top 10 compliance mapping</li> <li>EU AI Act compliance checker</li> <li>License compliance checking</li> <li>Incremental scanning with <code>--cache</code></li> <li>Watch mode with <code>ai-bom watch</code></li> <li>Multi-stage Docker image</li> <li>Expanded dependency parsing (Cargo.toml, go.mod, Gemfile, build.gradle, pom.xml, .csproj)</li> <li>Enhanced API key detection (Fireworks, Perplexity, DeepSeek, Together AI)</li> </ul>"},{"location":"changelog/#improvements","title":"Improvements","text":"<ul> <li>Multi-stage Dockerfile for smaller images</li> <li>Parallel CI with separate lint, typecheck, test, security jobs</li> <li>mypy type checking in CI</li> <li>pip-audit security scanning in CI</li> <li>Coverage threshold enforcement (80%)</li> <li>Encoding fallback chain in file scanning</li> <li>Symlink cycle detection</li> <li>Binary file detection</li> <li>Large file guard (&gt;10MB)</li> <li>PermissionError handling</li> <li>Pre-commit hooks configuration</li> <li>MkDocs documentation site</li> </ul>"},{"location":"changelog/#v200","title":"v2.0.0","text":"<ul> <li>9 scanners, 7 reporters</li> <li>XSS fix in HTML reporter</li> <li>313+ tests</li> <li>SPDX 3.0 support</li> <li>Policy enforcement</li> </ul>"},{"location":"ci-integration/","title":"CI/CD Integration","text":"<p>AI-BOM integrates into your CI/CD pipeline to continuously discover and inventory AI/LLM components in your codebase. Supported platforms include GitHub Actions (native action) and GitLab CI (reusable template).</p>"},{"location":"ci-integration/#github-actions","title":"GitHub Actions","text":""},{"location":"ci-integration/#quick-start","title":"Quick Start","text":"<pre><code>name: AI-BOM Scan\non: [push, pull_request]\n\npermissions:\n  security-events: write\n  contents: read\n\njobs:\n  ai-bom:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: trusera/ai-bom@v2\n        with:\n          format: sarif\n          fail-on: high\n</code></pre>"},{"location":"ci-integration/#action-inputs","title":"Action Inputs","text":"Input Description Default <code>path</code> Directory to scan <code>.</code> <code>format</code> Output format (<code>sarif</code>, <code>cyclonedx</code>, <code>spdx</code>, <code>table</code>, <code>html</code>, <code>markdown</code>, <code>csv</code>) <code>table</code> <code>output</code> Output file path (prints to stdout if not set) <code>fail-on</code> Fail if any component meets this severity (<code>critical</code>, <code>high</code>, <code>medium</code>, <code>low</code>) <code>scan-level</code> Scanning depth: <code>quick</code>, <code>standard</code>, or <code>deep</code> <code>standard</code> <code>cedar-policy-file</code> Path to a Cedar policy file for policy evaluation <code>cedar-entities-file</code> Path to a Cedar entities file for additional context <code>policy-gate</code> Enable Cedar policy gate evaluation (<code>true</code>/<code>false</code>) <code>false</code>"},{"location":"ci-integration/#sarif-upload-to-github-security","title":"SARIF Upload to GitHub Security","text":"<p>When <code>format: sarif</code>, scan results are automatically uploaded to GitHub Code Scanning (requires <code>security-events: write</code> permission):</p> <pre><code>- uses: trusera/ai-bom@v2\n  with:\n    format: sarif\n    output: ai-bom-results.sarif\n    scan-level: deep\n</code></pre>"},{"location":"ci-integration/#cedar-policy-gate","title":"Cedar Policy Gate","text":"<p>The Cedar policy gate evaluates scan results against a Cedar-like policy file, enabling fine-grained control over which AI components are permitted in your codebase. See the Policy Enforcement section below for the policy file format.</p> <pre><code>- uses: trusera/ai-bom@v2\n  with:\n    format: table\n    scan-level: deep\n    policy-gate: \"true\"\n    cedar-policy-file: \".cedar/ai-policy.cedar\"\n</code></pre> <p>When a policy violation is detected, the action: 1. Exits with a non-zero code (fails the pipeline) 2. Prints a detailed violation table to the console 3. Writes a formatted violation report to the GitHub Actions job summary</p>"},{"location":"ci-integration/#gitlab-ci","title":"GitLab CI","text":""},{"location":"ci-integration/#quick-start_1","title":"Quick Start","text":"<p>Include the AI-BOM template in your <code>.gitlab-ci.yml</code>:</p> <pre><code>include:\n  - remote: 'https://raw.githubusercontent.com/Trusera/ai-bom/main/templates/gitlab-ci-ai-bom.yml'\n</code></pre> <p>This adds an <code>ai-bom-scan</code> job to the <code>security</code> stage that runs on merge requests and pushes to the default branch.</p>"},{"location":"ci-integration/#local-include","title":"Local Include","text":"<p>To pin the template to a specific version, copy it into your repository:</p> <pre><code>include:\n  - local: '.gitlab/ci/ai-bom.yml'\n</code></pre>"},{"location":"ci-integration/#variable-reference","title":"Variable Reference","text":"Variable Description Default <code>AI_BOM_VERSION</code> AI-BOM package version to install <code>latest</code> <code>AI_BOM_SCAN_PATH</code> Directory to scan <code>.</code> <code>AI_BOM_FORMAT</code> Output format (<code>sarif</code>, <code>cyclonedx</code>, <code>spdx</code>, <code>json</code>, <code>csv</code>, <code>html</code>, <code>markdown</code>, <code>table</code>) <code>sarif</code> <code>AI_BOM_FAIL_ON</code> Fail if any component meets this severity (<code>critical</code>, <code>high</code>, <code>medium</code>, <code>low</code>) (empty = no threshold) <code>AI_BOM_DEEP_SCAN</code> Enable deep scanning with AST analysis (<code>true</code>/<code>false</code>) <code>false</code> <code>AI_BOM_POLICY_FILE</code> Path to a Cedar policy file (enables the policy gate job) (empty = disabled) <code>AI_BOM_CEDAR_GATE_URL</code> URL to the cedar-gate.py script GitHub raw URL"},{"location":"ci-integration/#example-basic-sarif-scan","title":"Example: Basic SARIF Scan","text":"<p>The default configuration generates a SARIF report that integrates with GitLab's SAST results view:</p> <pre><code>include:\n  - remote: 'https://raw.githubusercontent.com/Trusera/ai-bom/main/templates/gitlab-ci-ai-bom.yml'\n</code></pre> <p>No additional configuration needed. Results appear in the GitLab Security Dashboard.</p>"},{"location":"ci-integration/#example-fail-on-high-severity","title":"Example: Fail on High Severity","text":"<pre><code>include:\n  - remote: 'https://raw.githubusercontent.com/Trusera/ai-bom/main/templates/gitlab-ci-ai-bom.yml'\n\nvariables:\n  AI_BOM_FAIL_ON: \"high\"\n  AI_BOM_DEEP_SCAN: \"true\"\n</code></pre>"},{"location":"ci-integration/#example-cedar-policy-gate","title":"Example: Cedar Policy Gate","text":"<pre><code>include:\n  - remote: 'https://raw.githubusercontent.com/Trusera/ai-bom/main/templates/gitlab-ci-ai-bom.yml'\n\nvariables:\n  AI_BOM_POLICY_FILE: \".cedar/ai-policy.cedar\"\n  AI_BOM_DEEP_SCAN: \"true\"\n</code></pre> <p>When <code>AI_BOM_POLICY_FILE</code> is set, the template automatically enables a second job (<code>ai-bom-policy-gate</code>) that runs after the scan.</p>"},{"location":"ci-integration/#example-cyclonedx-sbom-output","title":"Example: CycloneDX SBOM Output","text":"<pre><code>include:\n  - remote: 'https://raw.githubusercontent.com/Trusera/ai-bom/main/templates/gitlab-ci-ai-bom.yml'\n\nvariables:\n  AI_BOM_FORMAT: \"cyclonedx\"\n</code></pre> <p>The report artifact (<code>ai-bom-report.cdx.json</code>) is available for download for 30 days.</p>"},{"location":"ci-integration/#pipeline-badge","title":"Pipeline Badge","text":"<p>Add a badge to your README to show scan status:</p> <pre><code>[![AI-BOM Scan](https://gitlab.com/&lt;namespace&gt;/&lt;project&gt;/badges/&lt;branch&gt;/pipeline.svg)](https://gitlab.com/&lt;namespace&gt;/&lt;project&gt;/-/pipelines)\n</code></pre>"},{"location":"ci-integration/#cedar-policy-format","title":"Cedar Policy Format","text":"<p>The Cedar policy gate uses a simplified Cedar-like syntax. Each rule is a <code>forbid</code> statement that blocks deployment when conditions match.</p>"},{"location":"ci-integration/#supported-conditions","title":"Supported Conditions","text":"Field Type Description <code>resource.severity</code> string Component severity: <code>critical</code>, <code>high</code>, <code>medium</code>, <code>low</code>, <code>info</code> <code>resource.provider</code> string AI provider name (e.g., <code>DeepSeek</code>, <code>OpenAI</code>) <code>resource.component_type</code> string Component type (e.g., <code>llm-api</code>, <code>embedding</code>, <code>agent-framework</code>) <code>resource.risk_score</code> number Risk score from 0 to 100 <code>resource.name</code> string Component name"},{"location":"ci-integration/#supported-operators","title":"Supported Operators","text":"<p><code>==</code>, <code>!=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code></p> <p>Severity comparisons use ordinal ranking: <code>critical(4) &gt; high(3) &gt; medium(2) &gt; low(1) &gt; info(0)</code>.</p>"},{"location":"ci-integration/#example-policy-file","title":"Example Policy File","text":"<pre><code>// .cedar/ai-policy.cedar\n// Block all critical-severity components from deployment\nforbid (\n  principal,\n  action == Action::\"deploy\",\n  resource\n) when {\n  resource.severity == \"critical\"\n};\n\n// Block a specific provider\nforbid (\n  principal,\n  action == Action::\"deploy\",\n  resource\n) when {\n  resource.provider == \"DeepSeek\"\n};\n\n// Block components with risk score above threshold\nforbid (\n  principal,\n  action == Action::\"deploy\",\n  resource\n) when {\n  resource.risk_score &gt; 75\n};\n\n// Block high-severity LLM API integrations\nforbid (\n  principal,\n  action == Action::\"deploy\",\n  resource\n) when {\n  resource.component_type == \"llm-api\"\n  resource.severity == \"high\"\n};\n</code></pre>"},{"location":"ci-integration/#violation-report","title":"Violation Report","text":"<p>When a policy violation is detected, the gate produces a table like:</p> <pre><code>## Cedar Policy Gate - FAILED\n\n**2 violation(s) found**\n\n| # | Component | Type | Rule | Actual Value |\n|---|-----------|------|------|--------------|\n| 1 | openai-chat | llm-api | `resource.severity == \"critical\"` | critical |\n| 2 | deepseek-v3 | llm-api | `resource.provider == \"DeepSeek\"` | DeepSeek |\n</code></pre>"},{"location":"ci-integration/#policy-enforcement-legacy","title":"Policy Enforcement (Legacy)","text":""},{"location":"ci-integration/#severity-threshold","title":"Severity Threshold","text":"<p>Fail CI if findings meet a severity threshold:</p> <pre><code>ai-bom scan . --fail-on critical --quiet\n</code></pre>"},{"location":"ci-integration/#yaml-policy-file","title":"YAML Policy File","text":"<p>Create a YAML policy file for basic threshold control:</p> <pre><code># policy.yml\nmax_risk_score: 75\nblocked_providers:\n  - \"DeepSeek\"\nrequire_declared: true\nmax_components: 50\n</code></pre> <pre><code>ai-bom scan . --policy policy.yml\n</code></pre> <p>For more advanced rule-based policies, use the Cedar policy gate described above.</p>"},{"location":"cli-reference/","title":"CLI Reference","text":""},{"location":"cli-reference/#commands","title":"Commands","text":""},{"location":"cli-reference/#ai-bom-scan","title":"<code>ai-bom scan</code>","text":"<p>Scan a directory or repository for AI/LLM components.</p> <pre><code>ai-bom scan [TARGET] [OPTIONS]\n</code></pre> Option Description <code>TARGET</code> Path, directory, or git URL (default: <code>.</code>) <code>--format, -f</code> Output format (default: <code>table</code>) <code>--output, -o</code> Output file path <code>--deep</code> Enable AST-based Python analysis <code>--severity, -s</code> Minimum severity filter <code>--verbose, -v</code> Show scanner details and timing <code>--debug</code> Enable debug logging <code>--config</code> Path to .ai-bom.yml config file <code>--quiet, -q</code> Suppress banner and progress <code>--no-color</code> Disable colored output <code>--fail-on</code> Exit code 1 if severity threshold met <code>--policy</code> Path to YAML policy file <code>--save-dashboard</code> Save results to dashboard DB <code>--n8n-url</code> n8n instance URL for live scanning <code>--n8n-api-key</code> n8n API key <code>--n8n-local</code> Scan local ~/.n8n/ directory"},{"location":"cli-reference/#ai-bom-scan-cloud","title":"<code>ai-bom scan-cloud</code>","text":"<p>Scan a cloud provider for managed AI/ML services.</p> <pre><code>ai-bom scan-cloud &lt;PROVIDER&gt; [OPTIONS]\n</code></pre>"},{"location":"cli-reference/#ai-bom-diff","title":"<code>ai-bom diff</code>","text":"<p>Compare two scan results.</p> <pre><code>ai-bom diff &lt;SCAN1&gt; &lt;SCAN2&gt; [--format table|json|markdown]\n</code></pre>"},{"location":"cli-reference/#ai-bom-list-scanners","title":"<code>ai-bom list-scanners</code>","text":"<p>List all registered scanners and their status.</p>"},{"location":"cli-reference/#ai-bom-serve","title":"<code>ai-bom serve</code>","text":"<p>Start the REST API server.</p> <pre><code>ai-bom serve [--host 0.0.0.0] [--port 8080]\n</code></pre>"},{"location":"cli-reference/#ai-bom-dashboard","title":"<code>ai-bom dashboard</code>","text":"<p>Launch the web dashboard.</p>"},{"location":"cli-reference/#ai-bom-demo","title":"<code>ai-bom demo</code>","text":"<p>Run a demo scan on the bundled example project.</p>"},{"location":"cli-reference/#ai-bom-version","title":"<code>ai-bom version</code>","text":"<p>Show AI-BOM version.</p>"},{"location":"configuration/","title":"Configuration","text":""},{"location":"configuration/#config-file","title":"Config File","text":"<p>AI-BOM supports a <code>.ai-bom.yml</code> configuration file in your project root.</p> <pre><code># .ai-bom.yml\nformat: table\nseverity: medium\nverbose: true\nexclude:\n  - tests/fixtures/\n  - vendor/\n</code></pre> <p>Specify a custom config path:</p> <pre><code>ai-bom scan . --config path/to/.ai-bom.yml\n</code></pre>"},{"location":"configuration/#ai-bomignore","title":".ai-bomignore","text":"<p>Create a <code>.ai-bomignore</code> file (gitignore syntax) to exclude paths:</p> <pre><code># Skip test fixtures\ntests/fixtures/\ntests/test_data/\n\n# Skip vendored code\nvendor/\nthird_party/\n</code></pre>"},{"location":"configuration/#environment-variables","title":"Environment Variables","text":"Variable Description <code>AI_BOM_CONFIG</code> Path to config file <code>N8N_API_KEY</code> n8n API key for live scanning"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#pip-recommended","title":"pip (recommended)","text":"<pre><code>pip install ai-bom\n</code></pre>"},{"location":"installation/#pipx-isolated-install","title":"pipx (isolated install)","text":"<pre><code>pipx install ai-bom\n</code></pre>"},{"location":"installation/#from-source","title":"From source","text":"<pre><code>git clone https://github.com/trusera/ai-bom.git\ncd ai-bom\npip install -e \".[dev]\"\n</code></pre>"},{"location":"installation/#optional-dependencies","title":"Optional Dependencies","text":"<pre><code># All optional features\npip install ai-bom[all]\n\n# Specific features\npip install ai-bom[dashboard]   # Web dashboard\npip install ai-bom[server]      # REST API server\npip install ai-bom[watch]       # File watch mode\npip install ai-bom[docs]        # Documentation building\npip install ai-bom[aws]         # AWS live scanning\npip install ai-bom[gcp]         # GCP live scanning\npip install ai-bom[azure]       # Azure live scanning\n</code></pre>"},{"location":"installation/#docker","title":"Docker","text":"<pre><code>docker pull ghcr.io/trusera/ai-bom:latest\ndocker run -v $(pwd):/scan ghcr.io/trusera/ai-bom scan /scan\n</code></pre>"},{"location":"installation/#verify-installation","title":"Verify Installation","text":"<pre><code>ai-bom version\nai-bom list-scanners\n</code></pre>"},{"location":"interceptor-sdks/","title":"Universal Interceptor SDKs","text":"<p>Monitor every AI agent, enforce Cedar policies at runtime, and gain full observability -- regardless of language or framework. Trusera ships three open-source SDKs that share a single design philosophy: intercept, evaluate, report.</p> Python TypeScript Go Repository trusera-agent-sdk trusera-sdk-js trusera-sdk-go Package <code>trusera-sdk</code> (PyPI) <code>trusera-sdk</code> (npm) <code>github.com/Trusera/ai-bom/trusera-sdk-go</code> License Apache 2.0 Apache 2.0 Apache 2.0"},{"location":"interceptor-sdks/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Feature Comparison</li> <li>Architecture</li> <li>Quick Start</li> <li>Integration Guides for Top 10 Agent Frameworks</li> <li>Enforcement Modes</li> <li>Event Types Reference</li> <li>Configuration Reference</li> <li>Performance</li> <li>Migration Guide</li> </ol>"},{"location":"interceptor-sdks/#1-overview","title":"1. Overview","text":"<p>AI agents make autonomous decisions -- calling LLMs, invoking tools, reading databases, and hitting third-party APIs. Without observability, you are flying blind. Without enforcement, you have no guardrails.</p> <p>The Trusera Interceptor SDK family solves both problems:</p> <ul> <li>Intercept every outbound call your agent makes (HTTP requests, LLM invocations,   tool calls, file writes, data access, and decision points).</li> <li>Evaluate each action against Cedar policies -- the same policy language used by   AWS Verified Permissions -- in real time.</li> <li>Report a structured event stream to the Trusera platform for dashboards, alerts,   compliance audits, and forensic analysis.</li> </ul> <p>All three SDKs are designed around the same core concepts:</p> Concept Description Client Authenticated connection to the Trusera API. Handles batching and flushing. Interceptor Language-specific hook that transparently captures outbound calls. Event A structured record of a single agent action (tool call, LLM invoke, etc.). Enforcement Mode How policy violations are handled: <code>log</code>, <code>warn</code>, or <code>block</code>. Agent Registration One-time registration that ties events to a named agent identity. <p>Choose the SDK that matches your agent's language:</p> <ul> <li>Python SDK -- Best for LangChain, CrewAI, AutoGen, LlamaIndex, Semantic Kernel,   and any Python-based agent.</li> <li>TypeScript SDK -- Best for LangChain.js, Vercel AI SDK, OpenAI Node.js SDK,   and any Node.js/Bun agent.</li> <li>Go SDK -- Best for custom Go agents, microservices, and high-performance   infrastructure agents.</li> </ul>"},{"location":"interceptor-sdks/#2-feature-comparison","title":"2. Feature Comparison","text":"Feature Python TypeScript Go Package name <code>trusera-sdk</code> <code>trusera-sdk</code> <code>trusera-sdk-go</code> Install command <code>pip install trusera-sdk</code> <code>npm install trusera-sdk</code> <code>go get github.com/Trusera/ai-bom/trusera-sdk-go</code> HTTP Interception <code>@monitor</code> decorator <code>fetch</code> monkey-patch <code>http.RoundTripper</code> wrapper LangChain Integration <code>TruseraCallbackHandler</code> <code>TruseraLangChainHandler</code> -- CrewAI Integration <code>TruseraCrewCallback</code> (StepCallback) -- -- AutoGen Integration <code>TruseraAutoGenHook</code> (MessageHook) -- -- Enforcement Modes <code>log</code> / <code>warn</code> / <code>block</code> <code>log</code> / <code>warn</code> / <code>block</code> <code>log</code> / <code>warn</code> / <code>block</code> Event Batching Thread-based queue Timer-based queue Goroutine-based queue Async Support <code>asyncio</code> native Native <code>Promise</code> / <code>async-await</code> Goroutines External Dependencies <code>httpx</code> None (native <code>fetch</code>) None (stdlib only) Min Runtime Python 3.9+ Node.js 18+ Go 1.21+ Type Safety Type hints (mypy) Full TypeScript generics Static typing Context Manager <code>with</code> statement -- <code>defer client.Close()</code> Global Intercept <code>set_default_client()</code> <code>interceptor.install()</code> <code>trusera.InterceptDefault()</code> Exclude Patterns -- Regex patterns String patterns Block Patterns -- -- String patterns Agent Registration <code>client.register_agent()</code> <code>client.registerAgent()</code> <code>client.RegisterAgent()</code> Manual Flush <code>client.flush()</code> <code>await client.flush()</code> <code>client.Flush()</code> Graceful Shutdown <code>client.close()</code> <code>await client.close()</code> <code>client.Close()</code> Thread/Concurrency Safe Yes (threading lock) Yes (single-threaded + async) Yes (mutex + goroutines)"},{"location":"interceptor-sdks/#3-architecture","title":"3. Architecture","text":"<p>All three SDKs follow the same layered architecture. The interceptor sits between your agent code and the outside world, capturing events and optionally enforcing Cedar policies before requests leave the process.</p> <pre><code>                        Your Application\n                 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                 \u2502                             \u2502\n                 \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n                 \u2502   \u2502   AI Agent Code   \u2502     \u2502\n                 \u2502   \u2502  (LangChain,      \u2502     \u2502\n                 \u2502   \u2502   CrewAI, custom)  \u2502     \u2502\n                 \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n                 \u2502            \u2502                \u2502\n                 \u2502            \u2502  function call \u2502\n                 \u2502            \u25bc                \u2502\n                 \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n                 \u2502   \u2502  Trusera SDK      \u2502     \u2502\n                 \u2502   \u2502  Interceptor      \u2502     \u2502\n                 \u2502   \u2502                   \u2502     \u2502\n                 \u2502   \u2502  1. Capture args  \u2502     \u2502\n                 \u2502   \u2502  2. Evaluate      \u2502     \u2502\n                 \u2502   \u2502     Cedar policy  \u2502     \u2502\n                 \u2502   \u2502  3. Enforce       \u2502     \u2502\n                 \u2502   \u2502     (log/warn/    \u2502     \u2502\n                 \u2502   \u2502      block)       \u2502     \u2502\n                 \u2502   \u2502  4. Queue event   \u2502     \u2502\n                 \u2502   \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n                 \u2502       \u2502         \u2502            \u2502\n                 \u2502       \u2502 pass    \u2502 events     \u2502\n                 \u2502       \u2502 through \u2502 (batched)  \u2502\n                 \u2502       \u25bc         \u25bc            \u2502\n                 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502         \u2502\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u25bc                               \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502  External APIs  \u2502            \u2502  Trusera API    \u2502\n     \u2502  &amp; Tools        \u2502            \u2502                 \u2502\n     \u2502                 \u2502            \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n     \u2502  - OpenAI       \u2502            \u2502  \u2502  Cedar    \u2502  \u2502\n     \u2502  - Anthropic    \u2502            \u2502  \u2502  Policy   \u2502  \u2502\n     \u2502  - Databases    \u2502            \u2502  \u2502  Engine   \u2502  \u2502\n     \u2502  - File systems \u2502            \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n     \u2502  - Webhooks     \u2502            \u2502                 \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n                                    \u2502  \u2502 Dashboard \u2502  \u2502\n                                    \u2502  \u2502 &amp; Alerts  \u2502  \u2502\n                                    \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n                                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"interceptor-sdks/#interception-mechanisms-by-language","title":"Interception Mechanisms by Language","text":"<p>Python -- The <code>@monitor</code> decorator wraps functions at definition time. When a decorated function is called, the SDK captures input arguments, measures execution time, records the return value (or exception), and queues an event. A background thread flushes events to the Trusera API at configurable intervals.</p> <p>TypeScript -- The <code>TruseraInterceptor</code> replaces the global <code>fetch</code> function with a wrapper that captures request URL, method, headers, and body. After the real request completes, the SDK records the response status and queues an event. A <code>setInterval</code> timer drives periodic flushes.</p> <p>Go -- The SDK provides a custom <code>http.RoundTripper</code> that wraps the standard <code>http.Transport</code>. Every request passing through the wrapped <code>http.Client</code> is intercepted, measured, and recorded. A background goroutine flushes the event buffer on a ticker.</p>"},{"location":"interceptor-sdks/#4-quick-start","title":"4. Quick Start","text":""},{"location":"interceptor-sdks/#python","title":"Python","text":"<pre><code>from trusera_sdk import TruseraClient, Event, EventType\n\nclient = TruseraClient(api_key=\"tsk_your_api_key\")\nclient.register_agent(\"my-agent\", \"custom\")\n\nclient.track(Event(\n    type=EventType.TOOL_CALL,\n    name=\"web_search\",\n    payload={\"query\": \"latest AI news\"}\n))\n\nclient.close()\n</code></pre>"},{"location":"interceptor-sdks/#typescript","title":"TypeScript","text":"<pre><code>import { TruseraClient, TruseraInterceptor } from \"trusera-sdk\";\n\nconst client = new TruseraClient({\n  apiKey: \"tsk_your_api_key\",\n  agentId: \"my-agent\",\n});\n\nconst interceptor = new TruseraInterceptor();\ninterceptor.install(client, { enforcement: \"log\" });\n\n// All fetch() calls are now tracked automatically\nawait fetch(\"https://api.openai.com/v1/chat/completions\", {\n  method: \"POST\",\n  body: JSON.stringify({ model: \"gpt-4\", messages: [] }),\n});\n\nawait client.close();\ninterceptor.uninstall();\n</code></pre>"},{"location":"interceptor-sdks/#go","title":"Go","text":"<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"github.com/Trusera/ai-bom/trusera-sdk-go\"\n)\n\nfunc main() {\n    client := trusera.NewClient(\"tsk_your_api_key\")\n    defer client.Close()\n\n    client.RegisterAgent(\"my-agent\", \"custom\")\n\n    httpClient := trusera.WrapHTTPClient(&amp;http.Client{}, client, trusera.InterceptorOptions{\n        Enforcement: trusera.ModeLog,\n    })\n\n    // All requests through httpClient are tracked automatically\n    resp, _ := httpClient.Get(\"https://api.openai.com/v1/models\")\n    defer resp.Body.Close()\n}\n</code></pre>"},{"location":"interceptor-sdks/#5-integration-guides-for-top-10-agent-frameworks","title":"5. Integration Guides for Top 10 Agent Frameworks","text":""},{"location":"interceptor-sdks/#51-langchain-python","title":"5.1 LangChain (Python)","text":"<p>SDK: Python (<code>trusera-sdk[langchain]</code>)</p> <p>LangChain's callback system provides hooks for every LLM call, tool execution, and chain step. The <code>TruseraCallbackHandler</code> plugs directly into these hooks.</p> <pre><code>from langchain.llms import OpenAI\nfrom langchain.agents import initialize_agent, Tool\nfrom trusera_sdk import TruseraClient\nfrom trusera_sdk.integrations.langchain import TruseraCallbackHandler\n\nclient = TruseraClient(api_key=\"tsk_your_api_key\")\nclient.register_agent(\"langchain-agent\", \"langchain\")\nhandler = TruseraCallbackHandler(client)\n\nllm = OpenAI(callbacks=[handler])\nagent = initialize_agent(\n    tools=[\n        Tool(name=\"search\", func=search_fn, description=\"Search the web\"),\n    ],\n    llm=llm,\n    callbacks=[handler],\n)\n\n# Every LLM call, tool execution, and chain step is tracked\nagent.run(\"What are the top AI security risks?\")\nclient.close()\n</code></pre> <p>What gets tracked: <code>LLM_INVOKE</code> for each model call, <code>TOOL_CALL</code> for each tool execution, <code>DECISION</code> for chain-of-thought steps.</p>"},{"location":"interceptor-sdks/#52-langchainjs-nodejs","title":"5.2 LangChain.js (Node.js)","text":"<p>SDK: TypeScript (<code>trusera-sdk</code>)</p> <p>The TypeScript SDK provides a <code>TruseraLangChainHandler</code> that implements the LangChain.js <code>BaseCallbackHandler</code> interface.</p> <pre><code>import { ChatOpenAI } from \"langchain/chat_models/openai\";\nimport { TruseraClient, TruseraLangChainHandler } from \"trusera-sdk\";\n\nconst client = new TruseraClient({ apiKey: \"tsk_your_api_key\" });\nconst handler = new TruseraLangChainHandler(client);\n\nconst model = new ChatOpenAI({\n  callbacks: [handler],\n});\n\nawait model.invoke(\"What are the top AI security risks?\");\nawait client.close();\n</code></pre> <p>What gets tracked: Same event types as the Python LangChain integration -- <code>LLM_INVOKE</code>, <code>TOOL_CALL</code>, and <code>DECISION</code> events.</p>"},{"location":"interceptor-sdks/#53-crewai","title":"5.3 CrewAI","text":"<p>SDK: Python (<code>trusera-sdk[crewai]</code>)</p> <p>CrewAI uses a step callback pattern. The <code>TruseraCrewCallback</code> wraps this to capture crew execution, agent delegation, and task completion.</p> <pre><code>from crewai import Crew, Agent, Task\nfrom trusera_sdk import TruseraClient\nfrom trusera_sdk.integrations.crewai import TruseraCrewCallback\n\nclient = TruseraClient(api_key=\"tsk_your_api_key\")\nclient.register_agent(\"crew-agent\", \"crewai\")\ncallback = TruseraCrewCallback(client)\n\nresearcher = Agent(role=\"Researcher\", goal=\"Research AI trends\")\nwriter = Agent(role=\"Writer\", goal=\"Write reports\")\n\ntask = Task(description=\"Research and write about AI trends\", agent=researcher)\n\ncrew = Crew(\n    agents=[researcher, writer],\n    tasks=[task],\n    step_callback=callback.step_callback,\n)\n\nresult = crew.kickoff()\nclient.close()\n</code></pre> <p>What gets tracked: <code>DECISION</code> for each crew step, <code>TOOL_CALL</code> for agent tool use, <code>LLM_INVOKE</code> for underlying model calls.</p>"},{"location":"interceptor-sdks/#54-autogen","title":"5.4 AutoGen","text":"<p>SDK: Python (<code>trusera-sdk[autogen]</code>)</p> <p>AutoGen's hook system lets you intercept messages between agents. The <code>TruseraAutoGenHook</code> captures all inter-agent communication and tool use.</p> <pre><code>import autogen\nfrom trusera_sdk import TruseraClient\nfrom trusera_sdk.integrations.autogen import TruseraAutoGenHook\n\nclient = TruseraClient(api_key=\"tsk_your_api_key\")\nclient.register_agent(\"autogen-agent\", \"autogen\")\nhook = TruseraAutoGenHook(client)\n\nassistant = autogen.AssistantAgent(\n    name=\"assistant\",\n    llm_config={\"model\": \"gpt-4\"},\n)\nuser_proxy = autogen.UserProxyAgent(name=\"user\")\n\n# Register hook for message tracking\nhook.setup_agent(assistant)\n\nuser_proxy.initiate_chat(assistant, message=\"Analyze this data\")\nclient.close()\n</code></pre> <p>What gets tracked: <code>LLM_INVOKE</code> for each model call, <code>DECISION</code> for agent message routing, <code>TOOL_CALL</code> for code execution and function calls.</p>"},{"location":"interceptor-sdks/#55-llamaindex","title":"5.5 LlamaIndex","text":"<p>SDK: Python (<code>trusera-sdk</code>)</p> <p>LlamaIndex does not have a dedicated integration module, but the <code>@monitor</code> decorator works perfectly with LlamaIndex query engines and retrievers.</p> <pre><code>from llama_index.core import VectorStoreIndex, SimpleDirectoryReader\nfrom trusera_sdk import TruseraClient, monitor, set_default_client, EventType\n\nclient = TruseraClient(api_key=\"tsk_your_api_key\")\nclient.register_agent(\"llamaindex-agent\", \"llamaindex\")\nset_default_client(client)\n\ndocuments = SimpleDirectoryReader(\"data\").load_data()\nindex = VectorStoreIndex.from_documents(documents)\n\n@monitor(event_type=EventType.DATA_ACCESS)\ndef query_index(question: str) -&gt; str:\n    query_engine = index.as_query_engine()\n    response = query_engine.query(question)\n    return str(response)\n\n@monitor(event_type=EventType.LLM_INVOKE, name=\"llamaindex_query\")\ndef ask(question: str) -&gt; str:\n    return query_index(question)\n\nresult = ask(\"What are the key findings?\")\nclient.close()\n</code></pre> <p>What gets tracked: <code>DATA_ACCESS</code> for index queries, <code>LLM_INVOKE</code> for the top-level question-answering call.</p>"},{"location":"interceptor-sdks/#56-semantic-kernel-python","title":"5.6 Semantic Kernel (Python)","text":"<p>SDK: Python (<code>trusera-sdk</code>)</p> <p>Microsoft Semantic Kernel exposes functions as plugins. Wrap plugin functions with <code>@monitor</code> to capture every kernel invocation.</p> <pre><code>import semantic_kernel as sk\nfrom trusera_sdk import TruseraClient, monitor, set_default_client, EventType\n\nclient = TruseraClient(api_key=\"tsk_your_api_key\")\nclient.register_agent(\"sk-agent\", \"semantic-kernel\")\nset_default_client(client)\n\nkernel = sk.Kernel()\n\n@monitor(event_type=EventType.TOOL_CALL)\ndef search_web(query: str) -&gt; str:\n    # Your search implementation\n    return \"Search results for: \" + query\n\n@monitor(event_type=EventType.LLM_INVOKE)\nasync def invoke_kernel(prompt: str) -&gt; str:\n    result = await kernel.invoke_prompt(prompt)\n    return str(result)\n\nresult = await invoke_kernel(\"Summarize recent AI security papers\")\nclient.close()\n</code></pre> <p>What gets tracked: <code>TOOL_CALL</code> for plugin function invocations, <code>LLM_INVOKE</code> for kernel prompt calls.</p>"},{"location":"interceptor-sdks/#57-openai-agents-sdk","title":"5.7 OpenAI Agents SDK","text":"<p>SDK: Python (<code>trusera-sdk</code>) or TypeScript (<code>trusera-sdk</code>)</p> <p>The OpenAI Agents SDK can be instrumented from either language. Use the <code>@monitor</code> decorator in Python or the <code>fetch</code> interceptor in TypeScript.</p>"},{"location":"interceptor-sdks/#python_1","title":"Python","text":"<pre><code>from agents import Agent, Runner\nfrom trusera_sdk import TruseraClient, monitor, set_default_client, EventType\n\nclient = TruseraClient(api_key=\"tsk_your_api_key\")\nclient.register_agent(\"openai-agent\", \"openai-agents-sdk\")\nset_default_client(client)\n\n@monitor(event_type=EventType.TOOL_CALL)\ndef get_weather(city: str) -&gt; str:\n    return f\"72F in {city}\"\n\nagent = Agent(\n    name=\"weather-assistant\",\n    instructions=\"You help with weather queries.\",\n    tools=[get_weather],\n)\n\nresult = Runner.run_sync(agent, \"What is the weather in SF?\")\nclient.close()\n</code></pre>"},{"location":"interceptor-sdks/#typescript_1","title":"TypeScript","text":"<pre><code>import { TruseraClient, TruseraInterceptor } from \"trusera-sdk\";\n\nconst client = new TruseraClient({\n  apiKey: \"tsk_your_api_key\",\n  agentId: \"openai-agent\",\n});\n\nconst interceptor = new TruseraInterceptor();\ninterceptor.install(client, { enforcement: \"log\" });\n\n// The OpenAI Agents SDK uses fetch internally --\n// all API calls are captured automatically\nimport { Agent } from \"@openai/agents\";\n\nconst agent = new Agent({ name: \"assistant\" });\nconst result = await agent.run(\"What is the weather in SF?\");\n\nawait client.close();\ninterceptor.uninstall();\n</code></pre>"},{"location":"interceptor-sdks/#58-vercel-ai-sdk","title":"5.8 Vercel AI SDK","text":"<p>SDK: TypeScript (<code>trusera-sdk</code>)</p> <p>The Vercel AI SDK uses <code>fetch</code> internally for all model calls. The Trusera interceptor captures these transparently.</p> <pre><code>import { generateText } from \"ai\";\nimport { openai } from \"@ai-sdk/openai\";\nimport { TruseraClient, TruseraInterceptor } from \"trusera-sdk\";\n\nconst client = new TruseraClient({\n  apiKey: \"tsk_your_api_key\",\n  agentId: \"vercel-ai-agent\",\n});\n\nconst interceptor = new TruseraInterceptor();\ninterceptor.install(client, {\n  enforcement: \"warn\",\n  excludePatterns: [\"^http://localhost.*\"],\n});\n\n// All model calls through the Vercel AI SDK are captured\nconst { text } = await generateText({\n  model: openai(\"gpt-4\"),\n  prompt: \"Explain AI agent security in one paragraph.\",\n});\n\nconsole.log(text);\n\nawait client.close();\ninterceptor.uninstall();\n</code></pre> <p>What gets tracked: <code>API_CALL</code> events for every outbound HTTP request to the model provider, with URL, method, status code, and latency.</p>"},{"location":"interceptor-sdks/#59-custom-go-agents","title":"5.9 Custom Go Agents","text":"<p>SDK: Go (<code>trusera-sdk-go</code>)</p> <p>For Go agents built from scratch, wrap your <code>http.Client</code> and use manual event tracking for non-HTTP actions.</p> <pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"github.com/Trusera/ai-bom/trusera-sdk-go\"\n)\n\nfunc main() {\n    truseraClient := trusera.NewClient(\"tsk_your_api_key\",\n        trusera.WithAgentID(\"go-agent\"),\n    )\n    defer truseraClient.Close()\n\n    truseraClient.RegisterAgent(\"go-agent\", \"custom\")\n\n    // Wrap HTTP client -- all outbound requests are tracked\n    httpClient := trusera.WrapHTTPClient(&amp;http.Client{}, truseraClient, trusera.InterceptorOptions{\n        Enforcement:    trusera.ModeBlock,\n        BlockPatterns:  []string{\"malicious.com\"},\n        ExcludePatterns: []string{\"api.trusera.io\", \"localhost\"},\n    })\n\n    // HTTP calls are auto-tracked\n    resp, err := httpClient.Get(\"https://api.openai.com/v1/models\")\n    if err != nil {\n        fmt.Println(\"Blocked or failed:\", err)\n        return\n    }\n    defer resp.Body.Close()\n\n    // Track non-HTTP actions manually\n    event := trusera.NewEvent(trusera.EventDecision, \"route_selection\").\n        WithPayload(\"selected_route\", \"api_v2\").\n        WithPayload(\"confidence\", 0.92)\n    truseraClient.Track(event)\n}\n</code></pre>"},{"location":"interceptor-sdks/#510-custom-python-agents","title":"5.10 Custom Python Agents","text":"<p>SDK: Python (<code>trusera-sdk</code>)</p> <p>For custom Python agents that do not use a framework, the <code>@monitor</code> decorator is the recommended approach.</p> <pre><code>from trusera_sdk import TruseraClient, monitor, set_default_client, EventType\nimport httpx\n\nclient = TruseraClient(api_key=\"tsk_your_api_key\")\nclient.register_agent(\"custom-agent\", \"custom\")\nset_default_client(client)\n\n@monitor(event_type=EventType.LLM_INVOKE, name=\"call_openai\")\ndef call_openai(prompt: str) -&gt; str:\n    response = httpx.post(\n        \"https://api.openai.com/v1/chat/completions\",\n        json={\"model\": \"gpt-4\", \"messages\": [{\"role\": \"user\", \"content\": prompt}]},\n        headers={\"Authorization\": \"Bearer sk-...\"},\n    )\n    return response.json()[\"choices\"][0][\"message\"][\"content\"]\n\n@monitor(event_type=EventType.TOOL_CALL, name=\"search_db\")\ndef search_database(query: str) -&gt; list[dict]:\n    # Your database logic\n    return [{\"id\": 1, \"title\": \"Result\"}]\n\n@monitor(event_type=EventType.DECISION, name=\"agent_loop\")\ndef agent_step(user_input: str) -&gt; str:\n    context = search_database(user_input)\n    prompt = f\"Context: {context}\\nQuestion: {user_input}\"\n    return call_openai(prompt)\n\nanswer = agent_step(\"What are our top vulnerabilities?\")\nprint(answer)\nclient.close()\n</code></pre> <p>What gets tracked: <code>LLM_INVOKE</code> for every OpenAI call, <code>TOOL_CALL</code> for every database search, <code>DECISION</code> for each agent loop iteration -- all with timing, input arguments, and return values.</p>"},{"location":"interceptor-sdks/#6-enforcement-modes","title":"6. Enforcement Modes","text":"<p>All three SDKs support three enforcement modes that control what happens when a policy violation is detected.</p>"},{"location":"interceptor-sdks/#61-log-mode-default","title":"6.1 Log Mode (Default)","text":"<p>Events are recorded silently. No output to the console, no exceptions thrown, no requests blocked. This is the safest mode for initial rollout.</p> <p>When to use: Development, staging, initial production deployment, audit-only compliance.</p>"},{"location":"interceptor-sdks/#python_2","title":"Python","text":"<pre><code># Log mode is the default -- no configuration needed\nclient = TruseraClient(api_key=\"tsk_your_api_key\")\n</code></pre>"},{"location":"interceptor-sdks/#typescript_2","title":"TypeScript","text":"<pre><code>interceptor.install(client, { enforcement: \"log\" });\n// fetch(\"https://restricted-api.com\") -&gt; request proceeds, event recorded silently\n</code></pre>"},{"location":"interceptor-sdks/#go_1","title":"Go","text":"<pre><code>opts := trusera.InterceptorOptions{\n    Enforcement: trusera.ModeLog,\n}\n// httpClient.Get(\"https://restricted-api.com\") -&gt; request proceeds, event recorded\n</code></pre>"},{"location":"interceptor-sdks/#62-warn-mode","title":"6.2 Warn Mode","text":"<p>Events are recorded and a warning is emitted. In Python this logs a warning, in TypeScript it prints to <code>console.warn</code>, in Go it writes to <code>log.Printf</code>. Requests are NOT blocked.</p> <p>When to use: Pre-production hardening, gradual policy rollout, alerting teams to violations without breaking workflows.</p>"},{"location":"interceptor-sdks/#python_3","title":"Python","text":"<pre><code># Warning appears in logs:\n# [Trusera] WARN: Policy violation detected for tool_call \"restricted_api\"\n</code></pre>"},{"location":"interceptor-sdks/#typescript_3","title":"TypeScript","text":"<pre><code>interceptor.install(client, { enforcement: \"warn\" });\n// Console output: [Trusera] Policy violation (allowed): Unauthorized API access\n</code></pre>"},{"location":"interceptor-sdks/#go_2","title":"Go","text":"<pre><code>opts := trusera.InterceptorOptions{\n    Enforcement: trusera.ModeWarn,\n    BlockPatterns: []string{\"suspicious.com\"},\n}\n// Log output: [Trusera] WARN: request to suspicious.com matched block pattern\n// Request proceeds normally\n</code></pre>"},{"location":"interceptor-sdks/#63-block-mode","title":"6.3 Block Mode","text":"<p>Violations cause the request to fail. In Python an exception is raised, in TypeScript an <code>Error</code> is thrown, in Go the HTTP response is replaced with a synthetic 403. This is the strongest enforcement mode.</p> <p>When to use: Production enforcement, compliance-critical workloads, when you are confident your policies are correct.</p>"},{"location":"interceptor-sdks/#python_4","title":"Python","text":"<pre><code># Raises: trusera_sdk.PolicyViolationError: Blocked by policy: unauthorized_data_access\n</code></pre>"},{"location":"interceptor-sdks/#typescript_4","title":"TypeScript","text":"<pre><code>interceptor.install(client, { enforcement: \"block\" });\ntry {\n  await fetch(\"https://restricted-api.com/data\");\n} catch (err) {\n  // Error: [Trusera] Policy violation: Unauthorized API access\n  console.error(\"Blocked:\", err.message);\n}\n</code></pre>"},{"location":"interceptor-sdks/#go_3","title":"Go","text":"<pre><code>opts := trusera.InterceptorOptions{\n    Enforcement: trusera.ModeBlock,\n    BlockPatterns: []string{\"malicious.com\"},\n}\nhttpClient := trusera.WrapHTTPClient(&amp;http.Client{}, truseraClient, opts)\n\nresp, err := httpClient.Get(\"https://malicious.com/exfiltrate\")\n// err != nil: request blocked by Trusera policy\n</code></pre>"},{"location":"interceptor-sdks/#enforcement-mode-summary","title":"Enforcement Mode Summary","text":"Mode Logs Event Console Output Blocks Request Use Case <code>log</code> Yes No No Audit, development <code>warn</code> Yes Yes (warning) No Staging, gradual rollout <code>block</code> Yes Yes (error) Yes Production enforcement"},{"location":"interceptor-sdks/#7-event-types-reference","title":"7. Event Types Reference","text":"<p>All three SDKs share the same six event types. These provide a consistent schema across languages, making it possible to query and visualize events from Python, TypeScript, and Go agents in a single Trusera dashboard.</p>"},{"location":"interceptor-sdks/#71-tool_call","title":"7.1 TOOL_CALL","text":"<p>Records a tool or function invocation by the agent.</p> Field Type Description <code>type</code> <code>string</code> <code>\"tool_call\"</code> <code>name</code> <code>string</code> Tool identifier (e.g., <code>\"web_search\"</code>, <code>\"calculator\"</code>) <code>payload</code> <code>object</code> Input arguments and parameters <code>metadata</code> <code>object</code> Duration, status, framework-specific data <p>Example Payload: <pre><code>{\n  \"type\": \"tool_call\",\n  \"name\": \"web_search\",\n  \"payload\": {\n    \"query\": \"AI security best practices\",\n    \"results_count\": 10\n  },\n  \"metadata\": {\n    \"duration_ms\": 250,\n    \"status\": \"success\"\n  }\n}\n</code></pre></p>"},{"location":"interceptor-sdks/#72-llm_invoke","title":"7.2 LLM_INVOKE","text":"<p>Records an LLM inference call.</p> Field Type Description <code>type</code> <code>string</code> <code>\"llm_invoke\"</code> <code>name</code> <code>string</code> Model identifier (e.g., <code>\"gpt-4\"</code>, <code>\"claude-3\"</code>) <code>payload</code> <code>object</code> Model, tokens, temperature, prompt summary <code>metadata</code> <code>object</code> Latency, provider, cost estimate <p>Example Payload: <pre><code>{\n  \"type\": \"llm_invoke\",\n  \"name\": \"openai.gpt4\",\n  \"payload\": {\n    \"model\": \"gpt-4\",\n    \"prompt_tokens\": 150,\n    \"completion_tokens\": 75,\n    \"temperature\": 0.7\n  },\n  \"metadata\": {\n    \"duration_ms\": 1200,\n    \"provider\": \"openai\"\n  }\n}\n</code></pre></p>"},{"location":"interceptor-sdks/#73-data_access","title":"7.3 DATA_ACCESS","text":"<p>Records a data read or write operation.</p> Field Type Description <code>type</code> <code>string</code> <code>\"data_access\"</code> <code>name</code> <code>string</code> Data source identifier (e.g., <code>\"database.users.read\"</code>) <code>payload</code> <code>object</code> Query, table, operation type, row count <code>metadata</code> <code>object</code> Duration, data classification <p>Example Payload: <pre><code>{\n  \"type\": \"data_access\",\n  \"name\": \"database.users.read\",\n  \"payload\": {\n    \"table\": \"users\",\n    \"query\": \"SELECT * FROM users WHERE role = 'admin'\",\n    \"rows_returned\": 42\n  },\n  \"metadata\": {\n    \"duration_ms\": 15,\n    \"classification\": \"pii\"\n  }\n}\n</code></pre></p>"},{"location":"interceptor-sdks/#74-api_call","title":"7.4 API_CALL","text":"<p>Records an outbound HTTP API request. This event type is typically generated automatically by the HTTP interceptor.</p> Field Type Description <code>type</code> <code>string</code> <code>\"api_call\"</code> <code>name</code> <code>string</code> HTTP method and URL (e.g., <code>\"POST https://api.stripe.com/v1/charges\"</code>) <code>payload</code> <code>object</code> URL, method, status code, request/response size <code>metadata</code> <code>object</code> Latency, headers (redacted), TLS info <p>Example Payload: <pre><code>{\n  \"type\": \"api_call\",\n  \"name\": \"POST https://api.stripe.com/v1/charges\",\n  \"payload\": {\n    \"url\": \"https://api.stripe.com/v1/charges\",\n    \"method\": \"POST\",\n    \"status_code\": 200,\n    \"response_size_bytes\": 1524\n  },\n  \"metadata\": {\n    \"duration_ms\": 340,\n    \"tls_version\": \"1.3\"\n  }\n}\n</code></pre></p>"},{"location":"interceptor-sdks/#75-file_write","title":"7.5 FILE_WRITE","text":"<p>Records a file system write operation.</p> Field Type Description <code>type</code> <code>string</code> <code>\"file_write\"</code> <code>name</code> <code>string</code> Operation identifier (e.g., <code>\"save_report\"</code>) <code>payload</code> <code>object</code> File path, size, content type <code>metadata</code> <code>object</code> Duration, permissions <p>Example Payload: <pre><code>{\n  \"type\": \"file_write\",\n  \"name\": \"save_report\",\n  \"payload\": {\n    \"path\": \"/tmp/report.pdf\",\n    \"size_bytes\": 1024,\n    \"content_type\": \"application/pdf\"\n  },\n  \"metadata\": {\n    \"duration_ms\": 5\n  }\n}\n</code></pre></p>"},{"location":"interceptor-sdks/#76-decision","title":"7.6 DECISION","text":"<p>Records an agent decision point or reasoning step.</p> Field Type Description <code>type</code> <code>string</code> <code>\"decision\"</code> <code>name</code> <code>string</code> Decision identifier (e.g., <code>\"approve_transaction\"</code>) <code>payload</code> <code>object</code> Confidence score, reasoning, selected action <code>metadata</code> <code>object</code> Context, alternatives considered <p>Example Payload: <pre><code>{\n  \"type\": \"decision\",\n  \"name\": \"approve_transaction\",\n  \"payload\": {\n    \"confidence\": 0.95,\n    \"reasoning\": \"All fraud checks passed\",\n    \"selected_action\": \"approve\"\n  },\n  \"metadata\": {\n    \"alternatives\": [\"flag_for_review\", \"reject\"],\n    \"context\": \"transaction_id=txn_abc123\"\n  }\n}\n</code></pre></p>"},{"location":"interceptor-sdks/#8-configuration-reference","title":"8. Configuration Reference","text":""},{"location":"interceptor-sdks/#81-environment-variables","title":"8.1 Environment Variables","text":"<p>All three SDKs respect the same environment variables, providing a consistent configuration experience across languages.</p> Variable Description Default <code>TRUSERA_API_KEY</code> API key for authentication (required) <code>TRUSERA_API_URL</code> Base URL for the Trusera API <code>https://api.trusera.io</code> <pre><code>export TRUSERA_API_KEY=tsk_your_api_key\nexport TRUSERA_API_URL=https://api.trusera.io\n</code></pre>"},{"location":"interceptor-sdks/#82-programmatic-configuration","title":"8.2 Programmatic Configuration","text":""},{"location":"interceptor-sdks/#python_5","title":"Python","text":"<pre><code>client = TruseraClient(\n    api_key=\"tsk_your_api_key\",         # Required. Also reads TRUSERA_API_KEY\n    base_url=\"https://api.trusera.io\",  # API endpoint\n    flush_interval=5.0,                  # Seconds between auto-flushes\n    batch_size=100,                      # Max events per batch\n    timeout=10.0,                        # HTTP request timeout (seconds)\n)\n</code></pre> Parameter Type Default Description <code>api_key</code> <code>str</code> env <code>TRUSERA_API_KEY</code> Authentication key <code>base_url</code> <code>str</code> <code>https://api.trusera.dev</code> API base URL <code>flush_interval</code> <code>float</code> <code>5.0</code> Seconds between auto-flushes <code>batch_size</code> <code>int</code> <code>100</code> Maximum events per batch <code>timeout</code> <code>float</code> <code>10.0</code> HTTP timeout in seconds"},{"location":"interceptor-sdks/#typescript_5","title":"TypeScript","text":"<pre><code>const client = new TruseraClient({\n  apiKey: \"tsk_your_api_key\",       // Required. Also reads TRUSERA_API_KEY\n  baseUrl: \"https://api.trusera.io\", // API endpoint\n  agentId: \"my-agent\",              // Pre-registered agent ID\n  flushInterval: 5000,              // Milliseconds between auto-flushes\n  batchSize: 100,                   // Max events per batch\n  debug: false,                     // Enable debug logging\n});\n</code></pre> Parameter Type Default Description <code>apiKey</code> <code>string</code> env <code>TRUSERA_API_KEY</code> Authentication key <code>baseUrl</code> <code>string</code> <code>https://api.trusera.io</code> API base URL <code>agentId</code> <code>string</code> <code>undefined</code> Pre-registered agent ID <code>flushInterval</code> <code>number</code> <code>5000</code> Milliseconds between flushes <code>batchSize</code> <code>number</code> <code>100</code> Maximum events per batch <code>debug</code> <code>boolean</code> <code>false</code> Enable debug logging <p>Interceptor Options:</p> Parameter Type Default Description <code>enforcement</code> <code>\"log\" \\| \"warn\" \\| \"block\"</code> <code>\"log\"</code> Violation handling mode <code>policyUrl</code> <code>string</code> <code>undefined</code> Cedar policy service URL <code>excludePatterns</code> <code>string[]</code> <code>[]</code> URL regex patterns to skip <code>debug</code> <code>boolean</code> <code>false</code> Enable debug logging"},{"location":"interceptor-sdks/#go_4","title":"Go","text":"<pre><code>client := trusera.NewClient(\"tsk_your_api_key\",\n    trusera.WithBaseURL(\"https://api.trusera.io\"),\n    trusera.WithAgentID(\"my-agent\"),\n    trusera.WithFlushInterval(60 * time.Second),\n    trusera.WithBatchSize(200),\n)\n</code></pre> Option Function Type Default Description <code>WithBaseURL(url)</code> <code>string</code> <code>https://api.trusera.io</code> API base URL <code>WithAgentID(id)</code> <code>string</code> <code>\"\"</code> Pre-registered agent ID <code>WithFlushInterval(d)</code> <code>time.Duration</code> <code>5s</code> Duration between flushes <code>WithBatchSize(n)</code> <code>int</code> <code>100</code> Maximum events per batch <p>Interceptor Options:</p> Field Type Default Description <code>Enforcement</code> <code>Mode</code> <code>ModeLog</code> <code>ModeLog</code>, <code>ModeWarn</code>, or <code>ModeBlock</code> <code>ExcludePatterns</code> <code>[]string</code> <code>nil</code> URL patterns to skip <code>BlockPatterns</code> <code>[]string</code> <code>nil</code> URL patterns that trigger enforcement"},{"location":"interceptor-sdks/#9-performance","title":"9. Performance","text":"<p>The SDKs are designed to add negligible overhead to your agent's execution. Here are the key design principles and benchmarks.</p>"},{"location":"interceptor-sdks/#91-non-blocking-by-default","title":"9.1 Non-Blocking by Default","text":"<p>Event tracking (<code>track()</code> / <code>Track()</code>) is always non-blocking. Events are placed in an in-memory buffer and flushed asynchronously:</p> SDK Buffer Mechanism Flush Trigger Python <code>queue.Queue</code> + background <code>threading.Thread</code> Timer (default 5s) or batch size (default 100) TypeScript <code>Array</code> + <code>setInterval</code> Timer (default 5000ms) or batch size (default 100) Go <code>[]Event</code> + <code>sync.Mutex</code> + background goroutine <code>time.Ticker</code> (default 5s) or batch size (default 100)"},{"location":"interceptor-sdks/#92-overhead","title":"9.2 Overhead","text":"Operation Typical Overhead <code>track()</code> call &lt; 1 microsecond (buffer append) HTTP interception (per request) &lt; 0.5 ms (timestamp + event creation) Batch flush (100 events) 10-50 ms (single HTTP POST to Trusera API)"},{"location":"interceptor-sdks/#93-batching-strategy","title":"9.3 Batching Strategy","text":"<p>Events are accumulated in memory and sent in batches to minimize network round trips. A flush occurs when either condition is met:</p> <ol> <li>The batch buffer reaches <code>batch_size</code> events (default: 100).</li> <li>The flush timer fires (default: every 5 seconds).</li> </ol> <p>On shutdown (<code>close()</code> / <code>Close()</code>), a final flush sends any remaining events.</p>"},{"location":"interceptor-sdks/#94-failure-handling","title":"9.4 Failure Handling","text":"<p>If a flush fails (network error, API timeout), the SDKs handle it gracefully:</p> <ul> <li>Python: Logs the error via <code>logging.warning()</code>, discards the batch, continues.</li> <li>TypeScript: Logs via <code>console.warn()</code>, retries once, then discards.</li> <li>Go: Logs via <code>log.Printf()</code>, discards the batch, continues.</li> </ul> <p>The SDK will never crash your application due to a telemetry failure. Agent execution always takes priority.</p>"},{"location":"interceptor-sdks/#95-memory-footprint","title":"9.5 Memory Footprint","text":"<p>Each event consumes approximately 200-500 bytes in memory. With the default batch size of 100, the maximum buffer size before flush is roughly 50 KB -- negligible for any production workload.</p>"},{"location":"interceptor-sdks/#10-migration-guide","title":"10. Migration Guide","text":"<p>Switching between SDKs is straightforward because all three share the same event schema, API key format, and agent registration model. Events from any SDK appear identically in the Trusera dashboard.</p>"},{"location":"interceptor-sdks/#101-python-to-typescript","title":"10.1 Python to TypeScript","text":"Python TypeScript Equivalent <code>TruseraClient(api_key=...)</code> <code>new TruseraClient({ apiKey: ... })</code> <code>client.register_agent(name, framework)</code> <code>await client.registerAgent(name, framework)</code> <code>client.track(Event(...))</code> <code>client.track(createEvent(...))</code> <code>client.flush()</code> <code>await client.flush()</code> <code>client.close()</code> <code>await client.close()</code> <code>@monitor(event_type=...)</code> <code>interceptor.install(client, ...)</code> <code>EventType.TOOL_CALL</code> <code>EventType.TOOL_CALL</code> <code>TruseraCallbackHandler</code> <code>TruseraLangChainHandler</code> <p>Key differences: - TypeScript <code>flush()</code> and <code>close()</code> return Promises; always <code>await</code> them. - The TypeScript SDK uses <code>fetch</code> interception instead of a decorator pattern.   Wrap tool functions manually with <code>createEvent()</code> if you need per-function tracking. - CrewAI and AutoGen integrations are Python-only.</p>"},{"location":"interceptor-sdks/#102-python-to-go","title":"10.2 Python to Go","text":"Python Go Equivalent <code>TruseraClient(api_key=...)</code> <code>trusera.NewClient(\"api-key\", ...)</code> <code>client.register_agent(name, fw)</code> <code>client.RegisterAgent(name, fw)</code> <code>client.track(Event(...))</code> <code>client.Track(trusera.NewEvent(...))</code> <code>client.flush()</code> <code>client.Flush()</code> <code>client.close()</code> <code>client.Close()</code> <code>@monitor(...)</code> <code>trusera.WrapHTTPClient(...)</code> <code>EventType.TOOL_CALL</code> <code>trusera.EventToolCall</code> <code>with TruseraClient(...) as c:</code> <code>defer client.Close()</code> <p>Key differences: - Go uses functional options (<code>WithBaseURL</code>, <code>WithBatchSize</code>) instead of keyword arguments. - Go has <code>BlockPatterns</code> for URL-based policy enforcement; Python relies on Cedar policies. - No framework-specific callback handlers in Go. Use <code>WrapHTTPClient</code> for HTTP   interception and <code>Track()</code> for manual event recording. - Go events use a builder pattern: <code>NewEvent(...).WithPayload(k, v)</code>.</p>"},{"location":"interceptor-sdks/#103-typescript-to-go","title":"10.3 TypeScript to Go","text":"TypeScript Go Equivalent <code>new TruseraClient({ apiKey })</code> <code>trusera.NewClient(apiKey)</code> <code>client.registerAgent(name, fw)</code> <code>client.RegisterAgent(name, fw)</code> <code>client.track(createEvent(...))</code> <code>client.Track(trusera.NewEvent(...))</code> <code>await client.flush()</code> <code>client.Flush()</code> <code>await client.close()</code> <code>client.Close()</code> <code>interceptor.install(client, opts)</code> <code>trusera.WrapHTTPClient(httpClient, client, opts)</code> <code>interceptor.uninstall()</code> (use a different <code>http.Client</code> or stop using the wrapper) <code>EventType.TOOL_CALL</code> <code>trusera.EventToolCall</code> <p>Key differences: - Go wraps <code>http.Client</code> explicitly; TypeScript monkey-patches <code>globalThis.fetch</code>. - Go's <code>WrapHTTPClient</code> returns a new <code>*http.Client</code>; the original is untouched. - TypeScript's <code>excludePatterns</code> uses regex strings; Go's <code>ExcludePatterns</code> uses   simple substring matching. - Go does not support <code>policyUrl</code> in interceptor options; use <code>BlockPatterns</code> instead.</p>"},{"location":"interceptor-sdks/#104-shared-agent-identity","title":"10.4 Shared Agent Identity","text":"<p>The same agent ID works across all SDKs. If you register an agent in Python and later switch to Go, use the same agent ID to maintain continuity:</p> <pre><code># Python: register agent\nclient.register_agent(\"my-agent\", \"custom\")\n</code></pre> <pre><code>// Go: reuse the same identity\nclient := trusera.NewClient(\"tsk_same_api_key\",\n    trusera.WithAgentID(\"my-agent\"),\n)\n</code></pre> <p>All historical events remain associated with <code>my-agent</code> in the Trusera dashboard, regardless of which SDK generated them.</p>"},{"location":"interceptor-sdks/#further-reading","title":"Further Reading","text":"<ul> <li>Trusera Platform Documentation</li> <li>Cedar Policy Language</li> <li>Python SDK Reference</li> <li>TypeScript SDK Reference</li> <li>Go SDK Reference</li> <li>AI-BOM Scanner</li> </ul> <p>Apache 2.0 Licensed. Built by the Trusera team.</p>"},{"location":"policy/","title":"Policy Enforcement","text":""},{"location":"policy/#severity-threshold","title":"Severity Threshold","text":"<p>Fail CI if findings meet a severity threshold:</p> <pre><code>ai-bom scan . --fail-on critical --quiet\n</code></pre>"},{"location":"policy/#policy-file","title":"Policy File","text":"<p>Create a YAML policy file for fine-grained control:</p> <pre><code># policy.yml\nmax_risk_score: 75\nblocked_providers:\n  - \"DeepSeek\"\nrequire_declared: true\nmax_components: 50\n</code></pre> <pre><code>ai-bom scan . --policy policy.yml\n</code></pre>"},{"location":"quickstart/","title":"Quick Start","text":""},{"location":"quickstart/#basic-scan","title":"Basic Scan","text":"<pre><code># Scan current directory\nai-bom scan .\n\n# Scan a specific path\nai-bom scan /path/to/project\n\n# Scan a git repository\nai-bom scan https://github.com/user/repo.git\n</code></pre>"},{"location":"quickstart/#output-formats","title":"Output Formats","text":"<pre><code># CycloneDX SBOM\nai-bom scan . --format cyclonedx -o ai-bom.cdx.json\n\n# SARIF for GitHub Code Scanning\nai-bom scan . --format sarif -o results.sarif\n\n# CSV for spreadsheet\nai-bom scan . --format csv -o components.csv\n\n# HTML report\nai-bom scan . --format html -o report.html\n</code></pre>"},{"location":"quickstart/#filtering","title":"Filtering","text":"<pre><code># Only show high+ severity\nai-bom scan . --severity high\n\n# Fail CI if critical findings\nai-bom scan . --fail-on critical --quiet\n</code></pre>"},{"location":"quickstart/#verbose-mode","title":"Verbose Mode","text":"<pre><code># Show scanner details and timing\nai-bom scan . --verbose\n\n# Full debug output\nai-bom scan . --debug\n</code></pre>"},{"location":"quickstart/#cicd-integration","title":"CI/CD Integration","text":"<pre><code># GitHub Actions\n- uses: trusera/ai-bom@v2\n  with:\n    format: sarif\n    fail-on: high\n</code></pre>"},{"location":"quickstart/#demo","title":"Demo","text":"<pre><code>ai-bom demo\n</code></pre>"},{"location":"troubleshooting/","title":"Troubleshooting","text":""},{"location":"troubleshooting/#common-issues","title":"Common Issues","text":""},{"location":"troubleshooting/#no-components-detected","title":"No components detected","text":"<ul> <li>Ensure your project uses AI libraries that AI-BOM can detect</li> <li>Run <code>ai-bom list-scanners</code> to see available scanners</li> <li>Use <code>--verbose</code> to see which scanners ran</li> <li>Use <code>--deep</code> for Python AST analysis</li> </ul>"},{"location":"troubleshooting/#permission-errors","title":"Permission errors","text":"<p>AI-BOM skips files it can't read. Use <code>--verbose</code> to see skipped files.</p>"},{"location":"troubleshooting/#large-repositories-are-slow","title":"Large repositories are slow","text":"<ul> <li>Use <code>.ai-bomignore</code> to exclude directories</li> <li>Use <code>--cache</code> for incremental scanning</li> <li>Default excludes already skip <code>node_modules/</code>, <code>.git/</code>, etc.</li> </ul>"},{"location":"troubleshooting/#sarif-upload-fails","title":"SARIF upload fails","text":"<p>Ensure your workflow has <code>security-events: write</code> permission.</p>"},{"location":"troubleshooting/#encoding-errors","title":"Encoding errors","text":"<p>AI-BOM uses a fallback chain: UTF-8 -&gt; Latin-1 -&gt; skip. Files with unknown encodings are safely skipped.</p>"},{"location":"compliance/eu-ai-act/","title":"EU AI Act Compliance","text":"<p>AI-BOM checks AI components against EU AI Act requirements:</p> <ul> <li>Article 53 Transparency: Identifies AI systems that should be disclosed to users</li> <li>Annex III High-Risk Categories: Flags AI used in sensitive domains (biometrics, critical infrastructure, education, employment, law enforcement)</li> <li>General-Purpose AI Models: Identifies GPAI models requiring additional compliance</li> </ul>"},{"location":"compliance/eu-ai-act/#usage","title":"Usage","text":"<p>Compliance checks are automatically applied during scanning. Results appear in the risk assessment with relevant flags and OWASP categories.</p>"},{"location":"compliance/owasp/","title":"OWASP Agentic Top 10","text":"<p>AI-BOM maps findings to the OWASP Agentic Security Initiative Top 10 categories:</p> ID Category AI-BOM Detection A01 Prompt Injection User input to LLM patterns A02 Insecure Output Handling No output validation A03 Training Data Poisoning Custom training/fine-tuning A04 Model Denial of Service No rate limiting A05 Supply Chain Vulnerabilities Shadow AI, unvetted packages A06 Sensitive Information Disclosure Hardcoded API keys A07 Insecure Plugin Design MCP servers, unvalidated tools A08 Excessive Agency Code execution, HTTP tools A09 Overreliance No human-in-the-loop A10 Model Theft Exposed model endpoints"},{"location":"outputs/","title":"Output Formats","text":"<p>AI-BOM supports 9 output formats for different use cases.</p> Format Flag Best For Table <code>table</code> Terminal display CycloneDX 1.6 <code>cyclonedx</code> / <code>json</code> SBOM standard SARIF <code>sarif</code> GitHub Code Scanning SPDX 3.0 <code>spdx3</code> SBOM standard HTML <code>html</code> Shareable reports CSV <code>csv</code> Spreadsheet analysis JUnit XML <code>junit</code> CI/CD test results Markdown <code>markdown</code> Documentation"},{"location":"outputs/#usage","title":"Usage","text":"<pre><code>ai-bom scan . --format &lt;format&gt; -o &lt;output-file&gt;\n</code></pre>"},{"location":"scanners/","title":"Scanners","text":"<p>AI-BOM includes 13 scanners that detect AI components across different technologies.</p> Scanner Description File Types <code>code</code> AI SDK imports and usage .py, .js, .ts, .java, .go, .rs <code>docker</code> AI containers and services Dockerfile, docker-compose.yml <code>network</code> AI endpoints and credentials .env, .yaml, .json, .toml <code>cloud</code> Cloud AI services (IaC) .tf, .json, .yaml <code>n8n</code> n8n workflow AI nodes .json (n8n exports) <code>jupyter</code> Jupyter notebook AI usage .ipynb <code>github-actions</code> AI-powered GitHub Actions .github/workflows/*.yml <code>model-files</code> Binary model files .onnx, .pt, .safetensors, etc. <code>mcp-config</code> MCP server configs mcp.json, claude_desktop_config.json <code>ast</code> Deep Python AST analysis .py (requires --deep) <code>aws-live</code> Live AWS account scan (API calls) <code>gcp-live</code> Live GCP project scan (API calls) <code>azure-live</code> Live Azure subscription scan (API calls)"},{"location":"scanners/#list-available-scanners","title":"List Available Scanners","text":"<pre><code>ai-bom list-scanners\n</code></pre>"},{"location":"scanners/n8n/","title":"n8n Scanner","text":"<p>The n8n scanner detects AI components, agent chains, and security risks in n8n workflow automation files.</p>"},{"location":"scanners/n8n/#what-it-detects","title":"What It Detects","text":"Category Examples LLM providers OpenAI, Anthropic, Google Gemini, Ollama, Azure OpenAI, Mistral, Groq, Cohere, HuggingFace Agent nodes AI Agent, chains, orchestration flows Tools HTTP Request, Code, Workflow, Calculator, Wikipedia MCP clients MCP client tool nodes with SSE/stdio transports Embeddings OpenAI, Cohere, HuggingFace, Google, Ollama embeddings Vector stores Pinecone, ChromaDB, Qdrant, Supabase, Weaviate, in-memory"},{"location":"scanners/n8n/#security-checks","title":"Security Checks","text":"<p>The scanner flags the following risks:</p> <ul> <li><code>hardcoded_credentials</code> -- API keys or tokens embedded directly in node parameters</li> <li><code>webhook_no_auth</code> -- Webhook triggers with no authentication configured</li> <li><code>code_http_tools</code> -- Agents with both code execution and HTTP request tools (data exfiltration risk)</li> <li><code>mcp_unknown_server</code> -- MCP client connecting to a non-localhost server</li> <li><code>agent_chain_no_validation</code> -- Agent chains connected via executeWorkflow with no validation step</li> <li><code>multi_agent_no_trust</code> -- Multi-agent workflows without trust boundaries</li> <li>Dangerous code patterns -- <code>child_process</code>, <code>eval()</code>, <code>fs.writeFile</code>, dynamic <code>require()</code> in code nodes</li> </ul>"},{"location":"scanners/n8n/#usage","title":"Usage","text":""},{"location":"scanners/n8n/#scan-exported-workflow-files","title":"Scan exported workflow files","text":"<pre><code>ai-bom scan ./workflows/ --format table\n</code></pre>"},{"location":"scanners/n8n/#scan-a-single-workflow-json","title":"Scan a single workflow JSON","text":"<pre><code>ai-bom scan ./my-workflow.json --format sarif\n</code></pre>"},{"location":"scanners/n8n/#scan-a-live-n8n-instance-via-api","title":"Scan a live n8n instance via API","text":"<pre><code>ai-bom scan . --n8n-url http://localhost:5678 --n8n-api-key YOUR_API_KEY\n</code></pre> <p>The live API integration supports pagination and returns workflows from the running instance.</p>"},{"location":"scanners/n8n/#n8n-community-node","title":"n8n Community Node","text":"<p>The n8n-nodes-trusera community node lets you run AI-BOM scans directly inside n8n workflows. Install it from the n8n community nodes panel or via:</p> <pre><code>cd ~/.n8n\nnpm install n8n-nodes-trusera\n</code></pre> <p>The community node provides four nodes:</p> <ul> <li>Trusera Dashboard -- Fetches all workflows via n8n API, scans them, and returns an interactive HTML dashboard with remediation cards</li> <li>Trusera Scan -- Scans workflows for AI components and security risks</li> <li>Trusera Report -- Generates reports in multiple formats (Markdown, JSON summary)</li> <li>Trusera Policy -- Enforces security policies and fails workflows on threshold breaches</li> </ul> <p>The dashboard includes severity charts, OWASP LLM Top 10 mapping, per-flag remediation guidance, and optional AES-256-GCM password protection.</p> <p>Source code: <code>n8n-node/</code> in the AI-BOM repository.</p>"},{"location":"scanners/n8n/#file-detection","title":"File Detection","text":"<p>The scanner processes <code>.json</code> files and validates they are n8n workflows by checking for the presence of both <code>nodes</code> (array) and <code>connections</code> (object) keys.</p>"},{"location":"scanners/n8n/#agent-chain-analysis","title":"Agent Chain Analysis","text":"<p>When multiple agent nodes are connected in sequence, the scanner traces the chain and reports it. Cross-workflow agent chains (via executeWorkflow nodes) are also detected and flagged.</p>"}]}